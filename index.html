<link href="https://cdnjs.cloudflare.com/ajax/libs/angular-material/0.10.1/angular-material.min.css" type="text/css" rel="stylesheet">
<div ng-app="karaoke">
  <md-toolbar>
    <div class="md-toolbar-tools">
      <md-input-container>
        <label>Search</label>
        <input type="search" ng-model="query" />
      </md-input-container>
      <md-input-container>
        <label>Category</label>
        <md-select ng-model="style">
          <md-option value=''>Any</md-option>
          <md-option ng-repeat="item in styles" value="{{item}}">
            {{item}}
          </md-option>
        </md-select>
      </md-input-container>
    </div>
  </md-toolbar>
  <md-content class="ng-cloak" flex>
    <md-list>
      <md-list-item class="md-2-line" ng-repeat="song in songs | filter:{search:query, styles:style||''} | limitTo:100">
        <div class="md-list-item-text">
          <h3>{{song.title}}</h3>
          <p>{{song.artist}}</p>
          <div class="md-secondary">{{song.year}}</div>
        </div>
      </md-list-item>
    </md-list>
  </md-content>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.4/angular.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.4/angular-animate.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.4/angular-aria.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular-material/0.10.1/angular-material.min.js"></script>
<script>
  angular
    .module('karaoke', ['ngMaterial'])
    .run(function($rootScope, $http) {
      $http.get('e7ae9ce86b75e42f72cb27b0ca2b31c0.csv').success(function(data) {
        var styles = {};

        data = data.split("\n").slice(1);
        $rootScope.songs = data.map(function(line) {
          if (!line) return;
          var values = line.split(";"),
              title = values[0].replace(/"/g, ''),
              artist = values[1].replace(/"/g, '');

          values[6].split(",").forEach(function(style) {
            styles[style.replace(/"/g, '')] = true;
          });

          return {
            search: String([ title, artist ]),
            title: title,
            artist: artist,
            year: values[2],
            duo: values[3] === "1",
            styles: values[6],
          };
        });

        $rootScope.styles = Object.keys(styles).sort();
      });
    });
</script>
